---
layout: post
title: 'Adventures in Freebernetes: Introduction'
date: 2020-10-24 22:49:23.000000000 -07:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- FreeBSD Virtualization
tags:
- freebsd
- kubernetes
- virtualization
meta:
  _oembed_fa7c0db3bb7728ce37c0ef6049b398cd: <div class="embed-twitter"><blockquote
    class="twitter-tweet" data-width="550" data-dnt="true"><p lang="en" dir="ltr">My
    Chromebook BLINDS me every time I need to restart, because it turns the display
    brightness way up and leaves it there, even after I log in.<br><br>I understand
    why, to an extent, (I&#39;m not the only person who has dealt with not knowing
    if a display is broken or not) but... c&#39;mon.</p>&mdash; Karen Bruner (@fuzzyKB)
    <a href="https://twitter.com/fuzzyKB/status/1319512243847925760?ref_src=twsrc%5Etfw">October
    23, 2020</a></blockquote><script async src="https://platform.twitter.com/widgets.js"
    charset="utf-8"></script></div>
  _oembed_time_fa7c0db3bb7728ce37c0ef6049b398cd: '1603432315'
  _publicize_job_id: '50301123767'
  timeline_notification: '1603579767'
  _oembed_3bce0b7b812cc6af8a1e6c554e510351: <div class="embed-twitter"><blockquote
    class="twitter-tweet" data-width="500" data-dnt="true"><p lang="en" dir="ltr">As
    far as I can tell, it is not possible with existing Chrome OS tools, let alone
    the Linux shell, to create a bootable FreeBSD image on a USB drive.<br><br>1.
    Chrome OS does not support making the USB drive visible to Linux via raw device
    file, needed to run dd from the shell. 2/</p>&mdash; Karen Bruner (@fuzzyKB) <a
    href="https://twitter.com/fuzzyKB/status/1319535378022371328?ref_src=twsrc%5Etfw">October
    23, 2020</a></blockquote><script async src="https://platform.twitter.com/widgets.js"
    charset="utf-8"></script></div>
  _oembed_time_3bce0b7b812cc6af8a1e6c554e510351: '1603597179'
  _oembed_25c053be4999554489f1d4236c688c0b: <div class="embed-twitter"><blockquote
    class="twitter-tweet" data-width="500" data-dnt="true"><p lang="en" dir="ltr">Ok,
    I got the FreeBSD 13.0-CURRENT memstick image, used my ancient Linux laptop to
    dd it onto the USB drive.<br><br>My only HDMI display is my TV, sooooo I&#39;m
    currently sitting on the floor in front of it (don&#39;t have an HDMI cable +
    USB elongator for the keyboard to reach the couch).</p>&mdash; Karen Bruner (@fuzzyKB)
    <a href="https://twitter.com/fuzzyKB/status/1319742463527940097?ref_src=twsrc%5Etfw">October
    23, 2020</a></blockquote><script async src="https://platform.twitter.com/widgets.js"
    charset="utf-8"></script></div>
  _oembed_time_25c053be4999554489f1d4236c688c0b: '1603597956'
  _oembed_2b142712f70f30d3e1fd066a7e16abd9: <div class="embed-twitter"><blockquote
    class="twitter-tweet" data-width="500" data-dnt="true"><p lang="en" dir="ltr">Day
    2 of Operation Free BSD<br><br>I updated the BIOS last night. Now trying to see
    I can manually boot from the ZFS-on-root partition, except Ziggy and George are
    having their 11AM zoomies so I keep getting distracted and miss the menu to exit
    into the boot loader.</p>&mdash; Karen Bruner (@fuzzyKB) <a href="https://twitter.com/fuzzyKB/status/1320067211864621058?ref_src=twsrc%5Etfw">October
    24, 2020</a></blockquote><script async src="https://platform.twitter.com/widgets.js"
    charset="utf-8"></script></div>
  _oembed_time_2b142712f70f30d3e1fd066a7e16abd9: '1603598358'
  _oembed_99d285230217198fe6e2dbb189e6d684: <div class="embed-twitter"><blockquote
    class="twitter-tweet" data-width="500" data-dnt="true"><p lang="en" dir="ltr">That&#39;s
    not good. <a href="https://t.co/HmX92ta1SI">pic.twitter.com/HmX92ta1SI</a></p>&mdash;
    Karen Bruner (@fuzzyKB) <a href="https://twitter.com/fuzzyKB/status/1320096641840394241?ref_src=twsrc%5Etfw">October
    24, 2020</a></blockquote><script async src="https://platform.twitter.com/widgets.js"
    charset="utf-8"></script></div>
  _oembed_time_99d285230217198fe6e2dbb189e6d684: '1603607104'
  _oembed_efe4c01f982cce35c60d9791a8f8882b: <div class="embed-twitter"><blockquote
    class="twitter-tweet" data-width="500" data-dnt="true"><p lang="en" dir="ltr">Woohoo!
    Success! Booting from the ZFS root with no human intervention! <a href="https://t.co/Glj4WaJiHn">pic.twitter.com/Glj4WaJiHn</a></p>&mdash;
    Karen Bruner (@fuzzyKB) <a href="https://twitter.com/fuzzyKB/status/1320104084183994368?ref_src=twsrc%5Etfw">October
    24, 2020</a></blockquote><script async src="https://platform.twitter.com/widgets.js"
    charset="utf-8"></script></div>
  _oembed_time_efe4c01f982cce35c60d9791a8f8882b: '1603608103'
  _last_editor_used_jetpack: block-editor
  _edit_last: '108235749'
author:
  login: nightmarebeforedevops
  email: kbcontactxyz@gmail.com
  display_name: karenb
  first_name: Karen
  last_name: Bruner
permalink: "/2020/10/24/adventures-in-freebernetes-introduction/"
excerpt: Introduction to a series of experiments with FreeBSD and Kubernetes
---
<p><!-- wp:paragraph {"fontSize":"medium"} --></p>
<p class="has-medium-font-size"><em>Introduction to a series of experiments with FreeBSD and Kubernetes</em></p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p><a href="https://productionwithscissors.run/freebsd-virtualization-series/"><em>See all posts in this series</em></a></p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>For various reasons, some of which are far too scary even for this blog, I haven't felt really excited or motivated to hack on tech in a long time.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>I've worked a lot around Kubernetes recently, but, while Windows support is emerging, I wondered where it stood for <a href="https://www.freebsd.org/">FreeBSD</a>. I worked with FreeBSD for years and miss it.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":864,"sizeSlug":"large","linkDestination":"none"} --></p>
<figure class="wp-block-image size-large"><img src="{{ site.baseurl }}/assets/images/2020/10/5680040477_3796979f90_o.jpg?w=461" alt="Picture of a crocheted doll of the FreeBSD daemon, the operating system's mascot." class="wp-image-864" /><br />
<figcaption><em>My crocheted interpretation of the <a href="https://www.freebsd.org/copyright/daemon.html">BSD Daemon</a></em></figcaption>
</figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>As it stands, two main approaches for running Kubernetes on FreeBSD exist: running Docker using FreeBSD's Linux compatibility layer, or using <a href="https://wiki.freebsd.org/bhyve">bhyve</a>, a virtualization hypervisor for FreeBSD which can support various *BSD and Linux guests, with <a href="https://cbsd.io/">CBSD</a> as the management layer. bhyve became standard after I stopped working with FreeBSD, but as what seems to be like the natural progression along the lines of FreeBSD's <a href="https://wiki.freebsd.org/Jails">jail</a> system, I'm down with that.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>And all of a sudden, I was getting excited about tinkering with something again.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading --></p>
<h2 id="getting-started">Getting Started</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>All my work the last number of years has been in the cloud, and I'm not a PC gamer anymore, so the only hardware I have at home is either really old or a Chromebook. (I spent a long time working in or near machine rooms and data centers, and I'm hardly afraid of hardware, but it's not how I generally want to fill my spare time or my home.) While it's possible to get FreeBSD running on the virtual machine offerings on most? all? cloud providers, trying to do that in conjunction with tinkering through new stuff seemed less appealing to me, so I decided to look for a low-cost hardware option. I don't need a lot of power, but bhyve in particular has <a href="https://www.freebsd.org/doc/handbook/virtualization-host-bhyve.html">CPU requirements for virtualization</a>.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>My friend Brad offered his old <a href="https://www.intel.com/content/www/us/en/products/boards-kits/nuc/mini-pcs.html">NUC</a> which had been collecting dust. It has a compatible CPU (Intel Core i5 blahblahblah), so golden!</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading {"level":3} --></p>
<h3 id="installer">The Installer</h3>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>I grabbed the latest USB drive installer image for FreeBSD 13.0-CURRENT. FreeBSD 12 is the current release version, and it supports bhyve, but bleeding edge, or whatever.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>The FreeBSD installer .img file needs to be copied bytewise to the USB stick. Drop'n'drag to any file system type, let alone <code>FATxx</code>, is not an option. However, even though Chrome OS's native Linux support/emulation/whatever-they-want-to-call-it has improved dramatically, it's hardly seamless, and it doesn't support direct USB device access, so no <code>dd</code>. (I used my ancient Linux laptop instead, which makes scary noises whenever I try to open the lid with the broken hinge.)</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading {"level":3} --></p>
<h3 id="setup">The Setup</h3>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>I have one HDMI-compatible display: my TV. (I've decided to get an inexpensive HDMI capture interface to make future efforts like this easier, but I wasn't going to wait for one to show up.) So I set up the NUC, at least for now, in front of my TV, stringing a 20' Ethernet cable to the router in the next room for Internet, although that was probably unnecessary. Again, it had been so long since I installed FreeBSD from scratch, I couldn't remember if any options required a network connection, even with the installation drive. (Note: nothing I did during the installation process hit the network.)</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:separator --></p>
<hr class="wp-block-separator" />
<!-- /wp:separator --></p>
<p><!-- wp:paragraph --></p>
<p>In <a href="http://productionwithscissors.run/2020/10/25/adventures-in-freebernetes-installing-freebsd/">Part 1</a>, I'll write up step-by-step how I (eventually) successfully installed FreeBSD 13.0-CURRENT with ZFS-on-root.</p>
<p><!-- /wp:paragraph --></p>
